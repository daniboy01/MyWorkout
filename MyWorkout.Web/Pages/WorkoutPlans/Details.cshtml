@page
@model MyWorkout.Web.Pages.WorkoutPlans.DetailsModel
@{
}

<div class="card">
    <h4 class="h4 text-center">@Model.WorkoutPlan.Title</h4>
    <div class="row">
        <div class="col-md-3">
            <img class="w-100 mb-2" src="~/images/workoutPlan_covers/@(Model.WorkoutPlan.Id).jpg" />
        </div>
        @if (User.Identity.IsAuthenticated && User.Identity.Name.Equals(Model.UserName) || User.IsInRole("Administrator"))
        {
            <div class="col-md-1">
                <a asp-page="/WorkoutPlans/Edit" asp-route-id="@Model.WorkoutPlan.Id" class="btn btn-default">Edit</a>
            </div>
        }
        <div class="col-md-8">
            <dl class="row">
                <dt class="col-sm-3">Description</dt>
                <dd class="col-md-8">@Model.WorkoutPlan.Description</dd>
            </dl>
            <dl class="row">
                <dt class="col-sm-3">Exercises</dt>
                @foreach (var exercise in Model.Exercises)
                {
                    <li class="list-group-item">@exercise.Title</li>
                }
            </dl>
        </div>
    </div>


    @if (User.Identity.IsAuthenticated) 
    {
        <form asp-page-handler="CreateComment" class="p-3">
            <input type="hidden" asp-for="NewComment.WorkoutId" />
            <div class="d-flex comment p-3">
                <div class="d-flex flex-column align-items-center flex-lg-shrink-0 mr-3">
                    <i class="fa fa-user"></i>
                    <span class="text-muted">@(DateTime.Now.ToShortDateString())</span>
                </div>
                <textarea class="w-100" rows="4" asp-for="NewComment.Text"></textarea>
            </div>
            <div class="d-flex justify-content-end my-2">
                <button type="submit"  class="btn btn-outline-primary" value="">Make comment</button>
            </div>
        </form>
    }
    else
    {
        <div>You have to login to write comment!</div>
    }

    <div class="row">
        <div class="col">
            @foreach (var comment in Model.Comments)
            {
                <div class="card card-white post">
                    <div class="post-heading">
                        <div class="float-left image">
                            <img src="~/images/users/@(Model.LoadImage(comment.UserId))" class="img-circle avatar" alt="user profile image" width="50" height="50">
                        </div>
                        <div class="float-left meta">
                            <div class="title h5">
                                <a href="#"><b>@comment.UserName</b></a>
                                made a post.
                            </div>
                            <h6 class="text-muted time">@comment.CreatedAt.DateTime.ToShortDateString()<h6>
                        </div>
                    </div>
                    <div class="post-description">
                        <p>@comment.Text</p>

                    </div>
                </div>
            }
        </div>

    </div>

</div>
